# Genomic Epidemiology of *Acinetobacter baumannii* in Africa

This repository contains the bioinformatics pipeline, data processing scripts, and downstream analysis used to investigate the antimicrobial resistance (AMR) profiles and phylogenetic relationships of **372 *Acinetobacter baumannii* genomes** collected from across Africa.

## Project Overview

The goal of this study is to characterize the genomic population structure of African *A. baumannii* isolates, identifying dominant Sequence Types (STs), analyzing the prevalence of resistance genes, and determining plasmid-borne resistance mechanisms.

**Key Analysis Steps:**

1. **Quality Control:** Assessment of raw reads (FastQC + MultiQC) and assembly quality (QUAST).
2. **Core SNP Alignment & Phylogeny:** Using Snippy and IQ-TREE.
3. **Genomic Typing:** MLST (Pasteur scheme) and Plasmid reconstruction (MOB-suite).
4. **AMR Analytics:** Statistical analysis of gene burden and resistance prevalence.
5. **Visualization:** Generating figures (heatmaps, stacked bar charts, histograms).

---

## Repository Structure

* **`data/`**: Contains metadata, reference genomes, and intermediate mapping files.
* *Note: Raw genome FASTA files are excluded due to size constraints. (Sucessfully Added)*


* **`results/`**: Output tables (CSV/Excel) and Figures (`.png`) generated by the analysis.
* **`scripts/`**: All computational scripts.

---

## Installation & Dependencies

The analysis runs on a Linux/WSL environment using **Conda/Mamba**. You can recreate the necessary environments using the commands below.

### 1. Bioinformatics Tools (Snippy, IQ-TREE, MLST)

```bash
# Create environment for Phylogeny (Snippy + IQ-TREE)
conda create -n snippy_env -c bioconda -c conda-forge snippy iqtree

# Create environment for Typing (MLST)
conda create -n mlst_env -c bioconda -c conda-forge mlst

```

### 2. Python Analysis Tools (Pandas, Plotting)

```bash
# Create environment for Data Analysis & Visualization
conda create -n analysis_env -c conda-forge pandas matplotlib seaborn openpyxl

```

---

## Usage / Workflow

The scripts in the `scripts/` folder.

### Phase 1: Quality Control & Bioinformatics Pipeline

* **Pre-processing:**
* **FastQC & MultiQC** were run on raw FASTQ reads to assess sequencing quality.
* **QUAST** was run on assembled FASTA genomes to assess assembly metrics (N50, Contigs).
* *Note: These outputs are processed in Script 08.*


* `00_run_snippy.sh`: Generates core SNP alignment against reference **ERR10710700**.
* `00_run_iqtree.sh`: Builds Maximum Likelihood tree (GTR+ASC model, 1000 bootstraps).
* `00_run_mlst.sh`: Assigns Sequence Types (Pasteur scheme).
* `00_clean_tree.sh`: Formats tree labels for Microreact visualization.

### Phase 2: Data Processing & Cleaning (Python/Bash)

Cleaning raw reports and integrating MOB-suite plasmid data.

* `01_rename_amr_files.sh` - `03_merge_reports.sh`: Prepares raw AMR data.
* `04_filter_amr_matrix.py`: Creates the binary gene presence/absence matrix.
* `05_merge_mob_reports.py`: Aggregates plasmid clustering results.
* `06_link_amr_to_location.py`: Determines if genes are chromosomal or plasmid-borne.

### Phase 3: Statistical Analysis & Visualization (Python)

Generates the final tables and figures.

* **Quality Control Summary:** `08_generate_qc_stats.py` (Table 4.1 - Integrates FastQC/QUAST data).
* **Figures:**
* `plot_gene_burden.py` (Figure 4.1: Histogram of resistance genes).
* `plot_top20_prevalence.py` (Figure 4.2: Bar chart of common genes).
* `plot_heatmap_by_country.py` (Figure 4.3: Geographic heatmap).
* `plot_st_distribution.py` (Figure 4.4: Stacked bar chart of STs).
* `plot_faceted_source_st.py` (Figure 4.5: Isolation source analysis).


* **Tables:**
* `generate_dominant_st_table.py` (Table 4.7).
* `generate_st_prevalence_table.py` (Table 4.4).
* `generate_plasmid_table.py` (Table 4.5).


---

## Key Results

* **Phylogeny:** High-resolution core SNP tree revealing the population structure of African isolates.
* **Resistance Burden:** Analysis of the Gene Burden across different STs.
* **Plasmid Association:** Detailed breakdown of chromosomal vs. plasmid location for genes.

## License

This project is for academic research purposes.

---



---

## Software & References

The following bioinformatics tools and platforms were used in this analysis. Please refer to their official documentation for detailed usage instructions.

* **Snippy:** Core genome alignment and SNP calling.
* [https://github.com/tseemann/snippy](https://github.com/tseemann/snippy)


* **IQ-TREE 2:** Maximum Likelihood phylogenetics.
* [http://www.iqtree.org/](http://www.iqtree.org/)


* **MLST:** Multi-Locus Sequence Typing (Pasteur scheme).
* [https://github.com/tseemann/mlst](https://github.com/tseemann/mlst)


* **MOB-suite:** Plasmid reconstruction and typing.
* [https://github.com/phac-nml/mob-suite](https://github.com/phac-nml/mob-suite)


* **AMRFinderPlus:** Identification of antimicrobial resistance genes.
* [https://github.com/ncbi/amr](https://github.com/ncbi/amr)


* **PathogenWatch:** Genomic assembly and surveillance.
* [https://pathogen.watch/](https://pathogen.watch/)


* **Galaxy Platform:** Web-based platform used for running AMRFinderPlus.
* [https://usegalaxy.org/](https://usegalaxy.org/)


* **Microreact:** Phylogeographic visualization.
* [https://microreact.org/](https://microreact.org/)


* **Quality Control:**
* **FastQC:** [https://www.bioinformatics.babraham.ac.uk/projects/fastqc/](https://www.bioinformatics.babraham.ac.uk/projects/fastqc/)
* **MultiQC:** [https://multiqc.info/](https://multiqc.info/)
* **QUAST:** [https://quast.sourceforge.net/](https://quast.sourceforge.net/)



---
